<!DOCTYPE html>
<html lang="en>">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    
    
    <meta name="google-site-verification"
          content="c66gcm0iMw487a2YC6w7cFbrhhe_Mh_vVNC6Pt3Dak8">
    

    
    
    <meta name="theme-color" content="#f5f5f5">
    

    
    

    
    <title>
        
        Hexo 双线部署及性能优化
        &nbsp;|&nbsp;
        
        Woonden Bar
    </title>

    
    
    <link type="image/x-icon" rel="shortcut icon"
          href="/blog/favicon.png">
    

    
     <link rel="stylesheet" href="/blog/css/style.css">

</head>


<body>

<div class="body-wrapper">
    <header>
    <div class="container">

        
        <div>
            <h1 class="logo">
                <a href="/blog/">
                    Woonden Bar
                </a>
            </h1>
        </div>

        
        <nav class="navbar">
            <ul class="navbar-menus">
                
                <li class="navbar-menus-item">
                    <a href="/blog/">
                        
                        Home
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/categories">
                        
                        Categories
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/tags">
                        
                        Tags
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/about">
                        
                        About
                    </a>
                </li>
                
            </ul>
        </nav>

    </div>
</header>


    <div class="main">
    <div class="container">

        <article class="post-body">

    <div class="title">
        <h1 class="title-inner">
            Hexo 双线部署及性能优化
        </h1>

        <div class="title-meta">
            <span class="title-meta-time">
                2017-01-30
            </span>
        </div>
    </div>

    <div class="content">

        
        

        <p>本文旨在从两个方面对 Hexo 的访问速度进行优化。</p>
<h2 id="为主题设置外链字体库"><a href="#为主题设置外链字体库" class="headerlink" title="为主题设置外链字体库"></a>为主题设置外链字体库</h2><p>我使用的主题是 NexT，其字体默认使用 Google Fonts，而 Google Fonts 在国内的访问速度极其蛋疼，这也直接导致大陆地区加载博客极其缓慢。好在 Hexo 给出了自定义字体的选项，我们可以将字体库的引用改为国内 CDN。NexT 字体设置的官方文档：</p>
<blockquote>
<p><a href="http://theme-next.iissnan.com/theme-settings.html#fonts-customization" target="_blank" rel="external">http://theme-next.iissnan.com/theme-settings.html#fonts-customization</a></p>
</blockquote>
<p>打开 NexT 主题的设置文件 <code>_config.yml</code>，通过搜索找到 <code>font:</code> 这一栏，在 <code>host</code> 中，填入您找到的国内 CDN。目前我在使用的是下面这个：</p>
<blockquote>
<p><a href="https://fonts.css.network/" target="_blank" rel="external">https://fonts.css.network/</a></p>
</blockquote>
<p>此方法适用于其他使用 Google Fonts 的主题。</p>
<h2 id="Hexo-双线部署"><a href="#Hexo-双线部署" class="headerlink" title="Hexo 双线部署"></a>Hexo 双线部署</h2><p><strong>NOTICE HERE</strong>: 现在 Coding.net 非会员用户创建的 Coding Pages 在访问时时会加入几秒钟的广告，请谨慎考虑是否使用</p>
<p>在我之前写过的“Hexo 不完全指南”一文中，我仅使用了 Github 作为文章部署地址，这将导致国内用户访问我的博客不会特别快。解决方案就是将部署地址改为国内的 Coding，可是这将导致国外用户访问速度变慢。其实，我们可以通过一些简单的设置，实现国内访问 Coding 服务器，国外访问 Github 服务器的效果。</p>
<p>在此之前，我们需要做几个准备工作：</p>
<ol>
<li>注册 Coding 账号</li>
<li>新建一个名为 <code>[user_name].coding.me</code> 的公开仓库，并开启 pages 服务</li>
<li>绑定自定义域名</li>
<li>将 Coding 通过 SSH 密钥的方式与本机连接</li>
</ol>
<p>上述工作完成后，我们就可以开始下面的设置了。</p>
<h3 id="设置部署地址"><a href="#设置部署地址" class="headerlink" title="设置部署地址"></a>设置部署地址</h3><p>打开 Hexo 的 <code>_config.yml</code> 文件，将 <code>deploy</code> 这一栏改为如下代码，格式为 <code>名称： 仓库,分支</code>：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span>
<span class="line">  <span class="attribute">type</span>: git</span>
<span class="line">  <span class="attribute">repo</span>:</span>
<span class="line">    <span class="attribute">github</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:[user_name]/[user_name].github.io.git,master</span>
<span class="line">    <span class="attribute">coding</span>: git<span class="variable">@git</span>.coding.<span class="attribute">net</span>:[user_name]/[user_name].coding.me.git,master</span>
</pre></td></tr></table></figure>
<h3 id="设置域名解析"><a href="#设置域名解析" class="headerlink" title="设置域名解析"></a>设置域名解析</h3><p>我的域名目前托管在阿里云，并且可以自由选择 <code>解析路线</code>。如果您的域名供应商处没有提供此设置，可以考虑将域名 DNS 改为阿里云的 DNS 服务器。</p>
<p>在解析控制台中，将指向 Github Pages 的解析路线设置为 <code>海外</code>，将指向 Coding Pages 的解析路线设置为 <code>默认</code>，依次保存即可。</p>
<p><img src="http://oi0t0q67c.bkt.clouddn.com/blog_skill/HexoOptimization.png" alt=""></p>
<h2 id="一些链接"><a href="#一些链接" class="headerlink" title="一些链接"></a>一些链接</h2><ul>
<li>NexT 主题官网：<a href="http://theme-next.iissnan.com/" target="_blank" rel="external">http://theme-next.iissnan.com/</a></li>
<li>常用前端公共库 CDN 服务：<a href="https://css.net/" target="_blank" rel="external">https://css.net/</a></li>
<li>极客族公共加速服务：<a href="https://cdn.geekzu.org/" target="_blank" rel="external">https://cdn.geekzu.org/</a></li>
</ul>
<p>最后，对所有开源主义者和公益项目提供者表示由衷的感谢。</p>

    </div>

    
    
    
    

    
    
    
    

</article>

<div class="prev-next">
    <div class="wrapper">

        
        
        <div class="prev">
            <a href="/blog/Essay/AlcoholAndPeople/">
                < Newer
            </a>
        </div>
        

        
        
        <div class="next">
            <a href="/blog/Skill/SSGuide/">
                Older >
            </a>
        </div>
        

    </div>
</div>



    </div>
</div>

</div>

<footer>
    <div class="container text-center">

        
        <p class="copyright">
            <span>&copy; 2015 - 2017</span>
            <span> / </span>
            <span><a href="mailto:i@zyis.me">Aiden Zhao</a></span>
        </p>

    </div>
</footer>


</body>

</html>
