<!DOCTYPE html>
<html lang="en>">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    
    
    <meta name="google-site-verification"
          content="c66gcm0iMw487a2YC6w7cFbrhhe_Mh_vVNC6Pt3Dak8">
    

    
    
    <meta name="theme-color" content="#f9f9f9">
    

    
    

    
    <title>
        
        Hexo 不完全指北
        &nbsp;|&nbsp;
        
        Woonden Bar
    </title>

    
    
    <link type="image/x-icon" rel="shortcut icon"
          href="/blog/favicon.png">
    

    
    
    <link rel="author" content="/blog/humans.txt">
    

    
     <link rel="stylesheet" href="/blog/css/style.css">

</head>


<body>

<div class="body-wrapper">
    <header>
    <div class="container">

        
        <div>
            <h1 class="logo">
                <a href="/blog/">
                    Woonden Bar
                </a>
            </h1>
        </div>

        
        <nav class="navbar">
            <ul class="navbar-menus">
                
                <li class="navbar-menus-item">
                    <a href="/blog/">
                        
                        Home
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/categories">
                        
                        Categories
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/tags">
                        
                        Tags
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/blog/about">
                        
                        About
                    </a>
                </li>
                
            </ul>
        </nav>

    </div>
</header>


    <div class="main">
    <div class="container">

        <article class="post-body">

    <div class="title">
        <h1 class="title-inner">
            Hexo 不完全指北
        </h1>

        <div class="title-meta">
            <span class="title-meta-time">
                2016-12-08
            </span>
        </div>
    </div>

    <div class="content">

        
        

        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前决定迁移博客平台的时候选择了 jekyll，但在下愚笨，连 jekyll 的开发环境都没搭建成功，调整时只能先 push 到 github 才能看到效果，实属痛苦。今日花了一天时间，终于把博客迁移到了 Hexo，顿时有一种脱离苦海的感觉。虽说 Hexo 非常简单，但官方文档实在简略，第三方教程又繁杂不一，我在实践过程中还是遇到了不少问题，因此还是决定自己动手写上一写，一来帮助自己梳理思路，二来如果能帮到遇到相同问题的朋友就再好不过了。如有纰漏，欢迎斧正。</p>
<p><strong>注意：</strong></p>
<ol>
<li>我使用的开发环境为 Windows 10，工具为 Visual Studio Code，博客托管于 Github，图床为七牛云；</li>
<li>我不会把所有的步骤全部列出，而是仅列出我认为必要的部分。如果你有不懂的地方，还请自行谷歌。</li>
</ol>
<h2 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h2><h3 id="关于托管"><a href="#关于托管" class="headerlink" title="关于托管"></a>关于托管</h3><p>使用 Github Pages 托管 Hexo。如果你想要提高博客的访问速度，可以将你的 Hexo 部署在国内的 <a href="https://coding.net/" target="_blank" rel="external">Coding</a>。</p>
<h3 id="关于备份"><a href="#关于备份" class="headerlink" title="关于备份"></a>关于备份</h3><p>和 jekyll 不同，Hexo 的博客文件都需要在本地生成，再 push 到远程仓库的某一个分支，所以博客的源文件是无法直接同步至 github 的，活脱脱一个本地文件，几乎零容灾。</p>
<p>这时候我们只能“曲线救国”了。本来我打算使用同步型云盘直接备份整个文件夹，但这样实在既不优雅也不省心。偶然间在知乎看到了一位昵称为“CrazyMilk”的答主给出的方案(<a href="https://www.zhihu.com/question/21193762/answer/79109280" target="_blank" rel="external">点我查看原文链接</a>)，其思路是使用同一个仓库下的两个分支进行管理。主分支保存 Hexo 生成的博客文件，另一个分支保存 Hexo 文件夹的源文件。这种思路非常好，所以我也采用了这种方式进行管理。由于作者给出的回答较为简略，我将在下面的流程中详细演示。</p>
<h3 id="关于图床的选择和使用"><a href="#关于图床的选择和使用" class="headerlink" title="关于图床的选择和使用"></a>关于图床的选择和使用</h3><p>国内像样的图床确实不多，其中最优解大概就是七牛了吧。但七牛的存储管理实在蛋疼，于是也是使用了一个曲线救国的方案：通过一个名为 <code>qiniu upload files</code> 的 chrome 插件对图片进行批量管理，目前感觉良好。 </p>
<h2 id="安装并配置-Node-js-和-Git"><a href="#安装并配置-Node-js-和-Git" class="headerlink" title="安装并配置 Node.js 和 Git"></a>安装并配置 Node.js 和 Git</h2><p>接下来就要搞 Hexo 了。在使用 Hexo 之前，请先安装 Node.js 和 Git。官网地址：</p>
<ul>
<li>Hexo : <a href="https://nodejs.org/" target="_blank" rel="external">https://nodejs.org/</a></li>
<li>Git : <a href="https://git-scm.com/" target="_blank" rel="external">https://git-scm.com/</a></li>
</ul>
<p><strong>注意：</strong></p>
<ol>
<li>最好在科学上网的环境下访问网站并下载文件；</li>
<li>安装 Node.js 时，最好勾选将路径添加至环境变量的选项，可以省去后续自己添加的麻烦。</li>
</ol>
<p>安装完成后，在 Git Bash 或 cmd 中配置用户名和邮箱，并生成 ssh 密钥。登陆 Github 或 Coding，使用公钥将计算机与远程仓库关联。</p>
<h2 id="安装并配置-Hexo"><a href="#安装并配置-Hexo" class="headerlink" title="安装并配置 Hexo"></a>安装并配置 Hexo</h2><h3 id="安装-Hexo"><a href="#安装-Hexo" class="headerlink" title="安装 Hexo"></a>安装 Hexo</h3><p>在命令行中输入以下命令以安装 hexo-cli：</p>
<blockquote>
<p>npm install hexo-cli -g</p>
</blockquote>
<h3 id="初始化一个-Hexo-目录"><a href="#初始化一个-Hexo-目录" class="headerlink" title="初始化一个 Hexo 目录"></a>初始化一个 Hexo 目录</h3><p>等待安装完成后，在你认为合适的目录下创建一个新文件夹作为 Hexo 的根目录，在这个文件夹的空白处按住 <code>Shift</code> + <code>鼠标右键</code> ，点击 <code>在此处打开命令窗口</code>，输入以下命令以初始化一个 Hexo 目录：</p>
<blockquote>
<p>hexo init</p>
</blockquote>
<p>等待初始化完成后，输入以下命令以安装依赖包：</p>
<blockquote>
<p>npm install</p>
</blockquote>
<h3 id="验证-Hexo-是否安装成功"><a href="#验证-Hexo-是否安装成功" class="headerlink" title="验证 Hexo 是否安装成功"></a>验证 Hexo 是否安装成功</h3><p>在命令行中，输入以下命令以生成静态网站：</p>
<blockquote>
<p>hexo g</p>
</blockquote>
<p>完成后继续输入以下命令以本地运行：</p>
<blockquote>
<p>hexo s</p>
</blockquote>
<p>如果命令提示符反馈：<code>INFO  Hexo is running at http://localhost:4000/. Press Ctrl+C to stop.</code> ，那么请在浏览器地址栏中输入：</p>
<blockquote>
<p>localhost:4000</p>
</blockquote>
<p>如果出现以下页面，那么恭喜，你的 Hexo 已经成功部署到本地了！之后如果你需要调试你的博客内容，可以优先使用这种本地查看的方式。</p>
<p><strong>注意：</strong>在浏览器查看该页面时，必须保证命令提示符为打开状态。如果关闭命令提示符或者键入 <code>Ctrl</code> + <code>C</code> 停止服务，你的页面将变成空白页。</p>
<p><img src="http://oi0t0q67c.bkt.clouddn.com/blog_skill/HexoGuide_1.png" alt=""></p>
<h2 id="将本地的-Hexo-博客推送至-Github-Pages"><a href="#将本地的-Hexo-博客推送至-Github-Pages" class="headerlink" title="将本地的 Hexo 博客推送至 Github Pages"></a>将本地的 Hexo 博客推送至 Github Pages</h2><h3 id="配置一个合适的-Github-仓库"><a href="#配置一个合适的-Github-仓库" class="headerlink" title="配置一个合适的 Github 仓库"></a>配置一个合适的 Github 仓库</h3><p><strong>注意：</strong> 此步骤所以操作均在 Github 上进行，不需要将此仓库同步至本地。</p>
<p>新建一个用于存放 Hexo 的 Github 仓库，仓库名为 <code>{yourUserName}.github.io</code> 。比如，我的 github 用户名是 <code>varzy</code> ，那么我的仓库名应该是 <code>varzy.github.io</code>。</p>
<p>然后，重点来了。<strong>你的 master 分支将会用于存放 Hexo 在本地生成的网页文件，所以你需要新建一个新的分支并将其设为默认分支，该分支用于存放你的 Hexo 源文件，也就是将此分支用于备份。</strong>比如，我创建了一个名为 <code>hexo</code> 的分支，并将其设置为默认分支：</p>
<p><img src="http://oi0t0q67c.bkt.clouddn.com/blog_skill/HexoGuide_2.png" alt=""></p>
<p>打开该仓库的 <code>Settings</code>，将页面下拉至 <code>GitHub Pages</code> 位置，在 <code>Source</code> 中选择 <code>master branch</code> 并点击 <code>Save</code> 保存。如果不出意外，你将得到一个页面链接：<code>https://yourUserName.github.io</code>，这就是你之后将要访问的博客链接。</p>
<p>至此，Github 仓库部分的配置已经全部完成了。可能有小伙伴有疑问，是否可以先将该仓库全部配置好，再 clone 至本地，然后在该仓库的本地文件夹下初始化一个 Hexo 目录呢？经过我的尝试发现这是不行的。<code>hexo init</code> 命名将会清空该文件夹下的所有文件，包括 <code>.git</code> 隐藏目录，导致与远程仓库的链接断开。所以，老老实实用我现在的步骤进行操作吧~</p>
<h3 id="配置本地-Hexo-文件夹"><a href="#配置本地-Hexo-文件夹" class="headerlink" title="配置本地 Hexo 文件夹"></a>配置本地 Hexo 文件夹</h3><p>打开本地 Hexo 文件夹，使用 Visual Studio Code 等工具打开 <code>_config.yml</code>，在最下方找到 <code># Deployment</code>，将其修改为如下格式：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre></td><td class="code"><pre><span class="line"><span class="meta"># Deployment</span></span>
<span class="line"><span class="meta">## Docs: https:<span class="comment">//hexo.io/docs/deployment.html</span></span></span>
<span class="line"><span class="symbol">deploy:</span></span>
<span class="line"><span class="symbol">  type:</span> git</span>
<span class="line"><span class="symbol">  repo:</span> git@github.com:&#123;UserName&#125;<span class="class">/&#123;UserName&#125;.github.io.git</span>
<span class="line"><span class="symbol">  branch:</span> master</span></span>
</pre></td></tr></table></figure>
<p>保存并关闭 <code>_config.yml</code> 文件，在根目录空白处按下 <code>Shift</code> + <code>鼠标右键</code>，打开命令提示符，输入以下命令以安装 git 依赖文件：</p>
<blockquote>
<p>npm install hexo-deployer-git –save</p>
</blockquote>
<p><strong>注意：</strong>该命令仅适用于使用 git 方式进行部署的情况，如果你采用其他方式进行部署，还请自行查询相关命令。</p>
<h3 id="推送本地-Hexo-文件至-Github-Pages"><a href="#推送本地-Hexo-文件至-Github-Pages" class="headerlink" title="推送本地 Hexo 文件至 Github Pages"></a>推送本地 Hexo 文件至 Github Pages</h3><p>在命令提示符中输入以下命令以生成最新的网页文件并推送至远程仓库的 master 分支：</p>
<blockquote>
<p>hexo g -d</p>
</blockquote>
<h3 id="查看-Github-Pages"><a href="#查看-Github-Pages" class="headerlink" title="查看 Github Pages"></a>查看 Github Pages</h3><p>等待推送完成，你就可以在浏览器中访问你之前得到的 Github Pages 链接了，其格式应为：<code>https://yourUserName.github.io/</code>。</p>
<p>如果可以正常访问，那么恭喜，你的博客已经全部完成且可以正常使用了！不过不要慌着去写文章，接下来的微调和后续工作也是非常必要的。</p>
<h2 id="备份-Hexo-源文件"><a href="#备份-Hexo-源文件" class="headerlink" title="备份 Hexo 源文件"></a>备份 Hexo 源文件</h2><h3 id="连接-github-仓库并推送-Hexo-源文件"><a href="#连接-github-仓库并推送-Hexo-源文件" class="headerlink" title="连接 github 仓库并推送 Hexo 源文件"></a>连接 github 仓库并推送 Hexo 源文件</h3><p>这一步我将使用命令行的方式说明，当然你也可以用其他的 git 管理工具完成这一步，比如 VSCode 等。</p>
<p>在 Hexo 的根目录下打开 Git Bash 或者 cmd，输入以下命令以初始化一个 git 仓库：</p>
<blockquote>
<p>git init</p>
</blockquote>
<p>使用以下命令创建并切换至 <code>hexo</code> 分支：</p>
<blockquote>
<p>git checkout -b hexo</p>
</blockquote>
<p>添加所有文件到暂存区：</p>
<blockquote>
<p>git add .</p>
</blockquote>
<p>提交暂存区所有文件：</p>
<blockquote>
<p>git commit -m “{message}”</p>
</blockquote>
<p>通过 HTTPS 方式或者 SSH 方式连接远程仓库，推荐使用 SSH 方式：</p>
<blockquote>
<p>git remote add origin git@github.com:{UserName}/{UserName}.github.io.git</p>
</blockquote>
<p>推送 Hexo 目录下的文件至远程仓库的 <code>hexo</code> 分支：</p>
<blockquote>
<p>git push -u origin hexo</p>
</blockquote>
<p>至此，所有的备份工作就结束了。当你想要更新博客的时候，需要通过 <code>hexo g -d</code> 命令发布一次，这时，你更新过的内容会出现在 Github 仓库的 master 分支上，并且自动更新在 Github Pages 页面上，当你访问 UserName.github.io 就可以看到你刚刚更新的内容了。</p>
<p>但是 <code>hexo g -d</code> 只更新了远程仓库的 <code>master</code> 分支，你还需要通过再次推送源文件至 <code>hexo</code> 分支进行源文件的备份。所以，如果你想要更新博客内容，一般的流程是这样的：<code>本地调试</code> -&gt; <code>hexo g -d</code> -&gt; <code>git push origin hexo</code>。</p>
<h3 id="通过备份快速生成-Hexo-目录"><a href="#通过备份快速生成-Hexo-目录" class="headerlink" title="通过备份快速生成 Hexo 目录"></a>通过备份快速生成 Hexo 目录</h3><p>如果你更换了电脑，或者更换了硬盘，或者巴拉巴拉，总之就是你需要快速得到一份可以写博客的 Hexo 文件目录，操作也非常简单。</p>
<p>当然，你需要先安装 Node.js 和 Git，此过程于之前相同，在此不再赘述。</p>
<p>接着，输入以下命令以安装 Hexo 到本机：</p>
<blockquote>
<p>npm install hexo-cli -g</p>
</blockquote>
<p>然后你需要将整个 Github 仓库 clone 到本地：</p>
<blockquote>
<p>git clone git@github.com:{UserName}/{UserName}.github.io.git –depth 1</p>
</blockquote>
<p>由于博客这种东西一般不需要回退或查看以前的提交版本，所以这里加入 <code>--depth 1</code> 表示只克隆最近一次的提交。这样可以加快 clone 速度，减小文件夹体积。</p>
<p>在该仓库文件夹空白处按住 <code>Shift</code> + <code>鼠标右键</code> 打开命令提示符，输入以下命令以安装所有的依赖文件：</p>
<blockquote>
<p>npm install</p>
</blockquote>
<p>至此，本地 Hexo 文件应该已经可以正常使用了。可以通过在命令窗口输入 <code>hexo g</code> 以查看能否正常部署，如果一切正常，那么恭喜，你的 Hexo 文件已经和上一次备份时完全一致了，enjoy it!</p>
<h2 id="绑定自己的域名"><a href="#绑定自己的域名" class="headerlink" title="绑定自己的域名"></a>绑定自己的域名</h2><p>Github Pages 可以绑定自己的域名，这也就意味着你可以使用自己的域名去访问你的 Hexo 博客。在此不再赘述域名的申请和操作等步骤。</p>
<h3 id="搞定域名解析"><a href="#搞定域名解析" class="headerlink" title="搞定域名解析"></a>搞定域名解析</h3><p>在下愚笨，找了半天愣是没找到 Github Pages 给出的最新主机 IP，于是我就直接使用 CNAME 记录指向了我的 Github Pages 地址。事实证明这种方式是可行的。操作如下：</p>
<p>打开域名解析设置，添加两个 CNAME 记录，并分别添加 www 和裸域两种记录。这样做的目的是为了使带 www 的域名和不带 www 的域名都能正确进入博客。</p>
<p><img src="http://oi0t0q67c.bkt.clouddn.com/blog_skill/HexoGuide_3_new.png" alt=""></p>
<h3 id="添加-CNAME-文件到-Hexo-目录下的-source-文件夹"><a href="#添加-CNAME-文件到-Hexo-目录下的-source-文件夹" class="headerlink" title="添加 CNAME 文件到 Hexo 目录下的 source 文件夹"></a>添加 CNAME 文件到 Hexo 目录下的 source 文件夹</h3><p>在 Hexo 目录下的 source 文件夹下新建一个名为 <code>CNAME</code> 的文件，里面填写你想要绑定的域名。如果你想要绑定裸域，则只需要填写域名即可；如果想要加入 www 前缀，那么你需要填入 www.yourDomain。比如，我不喜欢加入 www 前缀，那么我的 CNAME 文件只需要写入：</p>
<p><img src="http://oi0t0q67c.bkt.clouddn.com/blog_skill/HexoGuide_4_new.png" alt=""></p>
<p><strong>注意：</strong>一定要将 CNAME 文件置于 source 文件夹下而不是 Hexo 根目录，否则你的域名将不能绑定成功。</p>
<h3 id="完成文件提交和-Github-方面的域名绑定"><a href="#完成文件提交和-Github-方面的域名绑定" class="headerlink" title="完成文件提交和 Github 方面的域名绑定"></a>完成文件提交和 Github 方面的域名绑定</h3><p>分别使用 <code>hexo g -d</code> 和 <code>git push origin hexo</code> 命令提交两个分支的文件。然后在 Github 中打开该远程仓库，点击 <code>Settings</code>，下拉至 <code>Github Pages</code> 选项卡，在 <code>Custom domain</code> 中填入你需要绑定的域名，然后点击 <code>Save</code> 保存。</p>
<p>至此，你的域名绑定就结束了，通过访问你的域名查看是否绑定成功吧。</p>
<h2 id="使用七牛云作为图床"><a href="#使用七牛云作为图床" class="headerlink" title="使用七牛云作为图床"></a>使用七牛云作为图床</h2><p>由于我的 Hexo 完全托管在 Github，那么如果我把所有的图片都放置在 Hexo 目录中，势必会引起文件夹体积的巨增，以及 push 时缓慢的速度。因此，图床是十分必要的。七牛作为老牌的云服务商，质量还是算是经得起考验的。同样，此处不再赘述七牛云的注册等步骤。</p>
<p>不得不说七牛的文件管理实在不甚好用，好在有朋友开发了不少第三方工具以供选择。而我选择的方案是一款叫做 <code>qiniu upload files</code> 的 chrome 插件。安装此插件后，使用七牛给出的密钥即可与之链接。该插件使用了类 Windows 文件夹的操作方式，使用起来比原版的不知道要高到哪里去了。</p>
<p>此处给出 <code>qiniu upload files</code> 插件的应用商店链接：<br><a href="https://chrome.google.com/webstore/detail/qiniu-upload-files/emmfkgdgapbjphdolealbojmcmnphdcc" target="_blank" rel="external">https://chrome.google.com/webstore/detail/qiniu-upload-files/emmfkgdgapbjphdolealbojmcmnphdcc</a></p>
<p>如果有不能科学上网的朋友，或者不愿意使用 chrome 插件的朋友，可以使用一款叫做 <code>MPic</code> 的桌面版软件。官网链接：<br><a href="http://mpic.lzhaofu.cn/" target="_blank" rel="external">http://mpic.lzhaofu.cn/</a></p>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>请查看在下的另一篇文章：<a href="http://varzy.me/2-Skill/HexoOptimization/">Hexo 双线部署及性能优化</a></p>
<h2 id="尾巴"><a href="#尾巴" class="headerlink" title="尾巴"></a>尾巴</h2><h3 id="一些注解"><a href="#一些注解" class="headerlink" title="一些注解"></a>一些注解</h3><ul>
<li><code>hexo g</code> == <code>hexo generate</code></li>
<li><code>hexo s</code> == <code>hexo server</code></li>
<li><code>hexo d</code> == <code>hexo deploy</code></li>
<li><code>hexo n</code> == <code>hexo new</code></li>
<li><code>hexo g -d</code> == <code>hexo generate</code> -&gt; <code>hexo deploy</code></li>
<li><code>npm install</code> == <code>npm i</code></li>
</ul>
<h3 id="一些链接"><a href="#一些链接" class="headerlink" title="一些链接"></a>一些链接</h3><ul>
<li>Hexo 官方网站 : <a href="https://hexo.io/zh-cn/" target="_blank" rel="external">https://hexo.io/zh-cn/</a></li>
<li>Hexo 官方文档 : <a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="external">https://hexo.io/zh-cn/docs/</a></li>
<li>NexT 主题官网 : <a href="http://theme-next.iissnan.com/" target="_blank" rel="external">http://theme-next.iissnan.com/</a></li>
<li>Visual Studio Code : <a href="https://code.visualstudio.com/" target="_blank" rel="external">https://code.visualstudio.com/</a></li>
<li>七牛云官网 : <a href="https://www.qiniu.com/" target="_blank" rel="external">https://www.qiniu.com/</a></li>
<li>CrazyMilk 给出的方案源地址(知乎) : <a href="https://www.zhihu.com/question/21193762/answer/79109280" target="_blank" rel="external">https://www.zhihu.com/question/21193762/answer/79109280</a></li>
</ul>
<h3 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h3><ul>
<li>可以通过给 git 添加代理的方式加速 clone, push 等操作的速度</li>
<li>如果想要将某些来自 Github 的主题 clone 至 themes 文件夹下，那么你将不能将这个文件夹直接 push 到 hexo 分支。解决方案是删除该主题文件夹下的 <code>.git</code> 隐藏文件夹</li>
<li>不要在 Hexo 根目录下添加 <code>.editorconfig</code> 文件，没什么卵用，还有可能导致 markdown 格式错乱</li>
<li>文章标题不能含有 “[]”，也就是中括号，它将导致你的页面生成失败</li>
</ul>

    </div>

    
    

    
    

</article>

<div class="prev-next">
    <div class="wrapper">

        
        
        <div class="prev">
            <a href="/blog/skill/github-pages/">
                < Newer
            </a>
        </div>
        

        
        
        <div class="next">
            <a href="/blog/mess/hello-hexo/">
                Older >
            </a>
        </div>
        

    </div>
</div>



    </div>
</div>

</div>

<footer>
    <div class="container text-center">

        
        <p class="copyright">
            <span>&copy; 2015 - 2017</span>
            <span> / </span>
            <span><a href="http://varzy.me" target="_blank">Aiden Zhao</a></span>
        </p>

    </div>
</footer>


</body>

</html>
